import{j as e,A as M,r as o,s as P,R as S,a as R}from"./index.js";const p={OPENAI:"openai",GROQ:"groq",OLLAMA:"ollama"},L=({provider:s,setProvider:r})=>e.jsxs("div",{children:[e.jsx("label",{children:"Select LLM Provider:"}),e.jsxs("select",{value:s,onChange:l=>r(l.target.value),className:"select select-bordered w-full",children:[e.jsx("option",{disabled:!0,selected:!0,children:"Select..."}),e.jsx("option",{value:p.OPENAI,children:"OpenAI"}),e.jsx("option",{value:p.GROQ,children:"Groq"}),e.jsx("option",{value:p.OLLAMA,children:"Ollama (local)"})]})]}),u={OPENAI:"openai",GROQ:"groq"},I=({provider:s,model:r,setModel:l,apiKey:n,setApiKey:d})=>e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"API key:"})}),e.jsx("input",{className:"input input-bordered w-full",type:"text",value:s===u.GROQ?n:"Coming soon...",onChange:c=>d(c.target.value),disabled:s===u.OPENAI})]}),s===u.GROQ&&e.jsx("div",{children:e.jsx("a",{href:"https://console.groq.com/keys",target:"_blank",children:"Get your groq API key"})}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Model:"})}),e.jsx("input",{className:"input input-bordered w-full",type:"text",value:"Coming soon...",onChange:c=>l(c.target.value),disabled:!0})]})]}),E=({modelSelected:s,setModel:r,address:l,setAddress:n,modelsAvailable:d,refreshModels:c})=>e.jsxs("div",{children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Address with Port:"})}),e.jsx("input",{className:"input input-bordered w-full",type:"text",value:l,onChange:t=>n(t.target.value)}),e.jsxs("div",{className:"flex flex-row gap-2 w-full",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Model:"})}),e.jsxs("select",{className:"select select-bordered w-full",value:s,onChange:t=>r(t.target.value),children:[e.jsx("option",{disabled:!0,selected:!0,children:"Select..."}),d.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsx("div",{className:"tooltip tooltip-left self-end","data-tip":"Refresh model list",children:e.jsx("button",{onClick:c,className:"btn btn-secondary",children:e.jsx(M,{className:"size-6"})})})]})]}),i={OPENAI:"openai",GROQ:"groq",OLLAMA:"ollama"},G=()=>{const[s,r]=o.useState(""),[l,n]=o.useState({openai:"",groq:"",ollama:""}),[d,c]=o.useState({openai:[],groq:[],ollama:[]}),[t,x]=o.useState({openai:"",groq:""}),[h,g]=o.useState(""),[j,f]=o.useState(""),[A,m]=o.useState(!1);o.useEffect(()=>{chrome.storage.sync.get(["isValid"],a=>{a.isValid!==void 0&&m(a.isValid)})},[]),o.useEffect(()=>{chrome.storage.sync.get(["provider","model","apiKeys","address"],a=>{r(a.provider||""),n(a.model||{openai:"",groq:"",ollama:""}),x(a.apiKeys||{openai:"",groq:""}),g(a.address||"")})},[]),o.useEffect(()=>{v()},[s]);const O=async()=>{await chrome.storage.sync.set({isValid:!1,apiKeys:t}),s===i.GROQ&&(await b()?(await chrome.storage.sync.set({isValid:!0}),f("Groq API key saved successfully!"),m(!0)):(f("Invalid API key. Please try again."),m(!1),await chrome.storage.sync.set({isValid:!1}))),await chrome.storage.sync.set({provider:s,model:l,apiKeys:t,address:h})},b=async()=>{try{return await P("hi",1),!0}catch{return!1}},N=async()=>{try{const a=await fetch(`${h}/api/tags`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok)throw new Error("Network response was not ok");return(await a.json()).models.map(w=>w.name)}catch(a){return console.error("Fetch operation error:",a),[]}},v=async()=>{let a=[];s===i.GROQ?a=["llama3:8b"]:s===i.OLLAMA&&(a=await N()),c(y=>({...y,[s]:a})),await chrome.storage.sync.set({models:{...d,[s]:a}})};return e.jsxs("div",{className:"prose m-4 flex flex-col",children:[e.jsx("div",{className:"flex flex-row justify-center",children:e.jsx("h1",{children:"Options"})}),e.jsx(L,{provider:s,setProvider:r}),s&&(s===i.OPENAI||s===i.GROQ)&&e.jsx(I,{provider:s,model:l[s],setModel:a=>n({...l,[s]:a}),apiKey:t[s],setApiKey:a=>x({...t,[s]:a})}),s&&s===i.OLLAMA&&e.jsx(E,{modelSelected:l[i.OLLAMA],setModel:a=>n({...l,[s]:a}),address:h,setAddress:g,modelsAvailable:d[i.OLLAMA],refreshModels:v}),e.jsx("button",{onClick:O,className:"btn btn-primary mt-4 w-full",type:"submit",children:"Save"}),e.jsx("div",{style:{color:A?"green":"red"},className:"h-4",children:j||" "})]})};S.render(e.jsx(R.StrictMode,{children:e.jsx(G,{})}),document.getElementById("options-root"));
