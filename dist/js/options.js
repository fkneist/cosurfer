import{r as n,j as e,s as M,R as w,a as O}from"./index.js";const l={OPENAI:"openai",GROQ:"groq",OLLAMA:"ollama"},L=()=>{const[s,r]=n.useState(""),[o,i]=n.useState({openai:"",groq:"",ollama:""}),[d,c]=n.useState({openai:[],groq:[],ollama:[]}),[a,p]=n.useState({openai:"",groq:""}),[m,x]=n.useState(""),[g,v]=n.useState(""),[f,u]=n.useState(null);n.useEffect(()=>{chrome.storage.sync.get(["isValid"],t=>{t.isValid!==void 0&&u(t.isValid)})},[]),n.useEffect(()=>{chrome.storage.sync.get(["provider","model","apiKeys","address"],t=>{r(t.provider||""),i(t.model||{openai:"",groq:"",ollama:""}),p(t.apiKeys||{openai:"",groq:""}),x(t.address||"")})},[]);const y=async()=>{chrome.storage.sync.set({isValid:!1,apiKeys:a}),s===l.GROQ&&(await b()?chrome.storage.sync.set({isValid:!0},()=>{v("Groq API key saved successfully!"),u(!0)}):(v("Invalid API key. Please try again."),u(!1),chrome.storage.sync.set({isValid:!1}))),chrome.storage.sync.set({provider:s,model:o,apiKeys:a,address:m})},b=async()=>{try{return await M("hi",1),!0}catch{return!1}};n.useEffect(()=>{j()},[s]);const A=async()=>{try{const t=await fetch(`${m}/api/tags`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("Network response was not ok");const h=await t.json();return console.log(h),h.models.map(N=>N.name)}catch(t){return console.error("There has been a problem with your fetch operation:",t),[]}},j=async()=>{console.log("Fetching models...");let t=[];s===l.GROQ?t=["llama3:8b"]:s===l.OLLAMA&&(t=await A()),c(h=>({...h,[s]:t})),chrome.storage.sync.set({models:{...d,[s]:t}})};return e.jsxs("div",{className:"prose m-4 flex flex-col",children:[e.jsx("div",{className:"flex flex-row justify-center",children:e.jsx("h1",{children:"Options"})}),e.jsx(S,{provider:s,setProvider:r}),s&&(s===l.OPENAI||s===l.GROQ)&&e.jsx(P,{provider:s,model:o[s],setModel:t=>i({...o,[s]:t}),apiKey:a[s],setApiKey:t=>p({...a,[s]:t})}),s&&s===l.OLLAMA&&e.jsx(k,{modelSelected:o[l.OLLAMA],setModel:t=>i({...o,[s]:t}),address:m,setAddress:t=>x(t),modelsAvailable:d[l.OLLAMA],refreshModels:j}),e.jsx("button",{onClick:y,className:"btn btn-primary mt-4 w-full",type:"submit",children:"Save"}),e.jsx("div",{style:{color:f?"green":"red"},className:"h-4",children:g||" "})]})},S=({provider:s,setProvider:r})=>e.jsxs("div",{children:[e.jsx("label",{children:"Select LLM Provider:"}),e.jsxs("select",{value:s,onChange:o=>r(o.target.value),className:"select select-bordered w-full",children:[e.jsx("option",{disabled:!0,selected:!0,children:"Select..."}),e.jsx("option",{value:l.OPENAI,children:"OpenAI"}),e.jsx("option",{value:l.GROQ,children:"Groq"}),e.jsx("option",{value:l.OLLAMA,children:"Ollama (local)"})]})]}),P=({provider:s,model:r,setModel:o,apiKey:i,setApiKey:d})=>e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"API key:"})}),e.jsx("input",{className:"input input-bordered w-full",type:"text",value:s===l.GROQ?i:"Coming soon...",onChange:c=>d(c.target.value),disabled:s===l.OPENAI})]}),s===l.GROQ&&e.jsx("div",{children:e.jsx("a",{href:"https://console.groq.com/keys",target:"_blank",children:"Get your groq API key"})}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Model:"})}),e.jsx("input",{className:"input input-bordered w-full",type:"text",value:"Coming soon...",onChange:c=>o(c.target.value),disabled:!0})]})]}),k=({modelSelected:s,setModel:r,address:o,setAddress:i,modelsAvailable:d,refreshModels:c})=>e.jsxs("div",{children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Address with Port:"})}),e.jsx("input",{className:"input input-bordered w-full",type:"text",value:o,onChange:a=>i(a.target.value)}),e.jsxs("div",{className:"flex flex-row gap-2 w-full",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Model:"})}),e.jsxs("select",{className:"select select-bordered w-full",value:s,onChange:a=>r(a.target.value),children:[e.jsx("option",{disabled:!0,selected:!0,children:"Select..."}),d.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsx("div",{className:"tooltip tooltip-left self-end","data-tip":"Refresh model list",children:e.jsx("button",{onClick:c,className:"btn btn-secondary",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})})})})]})]});w.render(e.jsx(O.StrictMode,{children:e.jsx(L,{})}),document.getElementById("options-root"));
